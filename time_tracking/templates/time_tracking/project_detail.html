{% extends "time_tracking/base.html" %}

{% load staticfiles %}

{% block title %}Time Tracking - {{project}}{% endblock %}

{% block brand %}{{project}}{% endblock %}

{% block content %}

<div class="row-fluid">

	<div class="span12">

		<div class="well well-small">

			<h3>Metrics</h3>
			
			<dl>
				<dt>Total Time Spent:</dt>
				<dd>[[UNKNOWN VALUE]]</dd>
				
				<dt>Last Recorded Effort:</dt>
				<dd>[[UNKNOWN VALUE]]</dd>
			</dl>

		</div>

	</div>

</div>

<div class="row-fluid">
	<div class="span6">
		<div class="well well-small">
			<h3>Open Records</h3>
			{% if open_records %}
			<table class="table table-condensed">
				<thead>
					<tr>
						<th>Start</th>
						<th>Category</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					{% for record in open_records %}
					{% ifchanged record.start_time.date %}
					<tr>
						<td colspan="3"><strong>{{ record.start_time.date }}</strong></td>
					</tr>
					{% endifchanged %}
					<tr>
						<td>{{record.start_time|time:"TIME_FORMAT" }}</td>
						<td>{{record.category}}</td>
						<td>
							<div class="btn-group">
								<a class="btn dropdown-toggle btn-mini" data-toggle="dropdown" href="#"> Action <span class="caret"></span> </a>
								<ul class="dropdown-menu">
									<li><a href="{{record.get_close_url}}">Close</a></li>
									<li class="divider"></li>
									<li><a href="{{record.get_edit_url}}">Edit</a></li>
									<li><a href="{{record.get_delete_url}}">Delete</a></li>
								</ul>
							</div>
						</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
			{% else %}
			<p>None</p>	
			{% endif %}
		</div>

	</div>

	<div class="span6">
		<div class="well well-small">
			<h3>Description</h3>
		</div>
	</div>

</div>

<div class="row-fluid">

	<div class="span6">
		<div class="well well-small">
			<h3>Closed Records</h3>
			{% if closed_records %}
			<table class="table table-condensed">
				<thead>
					<tr>
						<th>Start</th>
						<th>Close</th>
						<th>Category</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
				{% for record in closed_records %}
					{% ifchanged record.start_time.date %} 
						<tr>
							<td colspan="4"><strong>{{ record.start_time.date }}</strong></td>
						</tr>
					{% endifchanged %}
					<tr>
						<td>{{record.start_time|time:"TIME_FORMAT" }}</td>
						<td>{{record.end_time|time:"TIME_FORMAT" }}</td>
						<td>{{record.category}}</td>
						<td>
							<div class="btn-group">
								<a class="btn dropdown-toggle btn-mini" data-toggle="dropdown" href="#"> Action <span class="caret"></span> </a>
								<ul class="dropdown-menu">
									<li><a href="{{record.get_edit_url}}">Edit</a></li>
									<li><a href="{{record.get_delete_url}}">Delete</a></li>
								</ul>
							</div>
						</td>
					</tr>
				{% endfor %}
				</tbody>	
			</table>
			{% else %}
			<p>None</p>
			{% endif %}
		</div>
	</div>

	<div class="span6">
		<div class="well well-small">
			<h3>Task Breakdown</h3>
			
			<div id="placeholder" style="height: 300px">
				{% if categories %}
				&nbsp;
				{% else %}
				<h2 class="text-center">No Data</h2>
				{% endif %}
			</div>
		</div>
	</div>

</div>

{% endblock %}

{% block extrascript %}
	
	<script type="text/javascript" src="{% static "js/jquery.flot.js" %}"></script>
	<script type="text/javascript" src="{% static "js/jquery.flot.pie.js" %}"></script>
	<script type="text/javascript" src="{% static "js/bootstrap-datepicker.js" %}"></script>
	
	<script type="text/javascript">
	
	{% if categories %}
	
		$(function() {
	
			
				var data = [];
				{% for key, value in categories.items %}
				data[{{forloop.counter0}}] = {
					label: "{{key}}",
					data: {{value}}
				}
			{% endfor %}

				$.plot("#placeholder", data, {
				    series: {
				        pie: {
				            show: true
				        }
				    }
				});
			
		});
		
		{% endif %}
	</script>

{% endblock %}
				
